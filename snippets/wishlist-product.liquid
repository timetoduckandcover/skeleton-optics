{% capture id %}{{ product.id }}{% endcapture %}
{% for tag in customer.tags %}{% if tag contains id %}{% assign t = tag %}{% endif %}{% endfor %}
{% assign check = t.size | minus:id.size | modulo:2 %}
{% if check == 0 %}{% assign display = true %}{% endif %}

<div class="wishlist-wrapper">
	{% if display %}
		<a class="wishlist" href="javascript:void(0)">Wishlist</a>
	{% else %}
		<a href="/collections/wish-list"> Saved to Wishlist</a>
	{% endif %}
	<p class="wish-error" style="display:none">To add this product to your favorites you must <a href="/account">sign in</a> or <a href="/account/register">create an account</a>.</p>
	{% form 'customer' %}
		<input type="hidden" name="contact[email]" value="{{ customer.email }}"/>
		<input type="hidden" name="contact[tags]" value="{% if t.size > 0 %}x{{ t }}{% else %}{{ product.id }}{% endif %}" />
	{% endform %}
</div>

{% if display %}
	<script>
		$('.wishlist').click(function() {
			{% if customer %}
				$('.contact-form').submit();
			{% else %}
				$('.wish-error').show();
			{% endif %}
		});
	</script>
{% endif %}
